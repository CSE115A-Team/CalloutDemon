<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CalloutDemon</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>CalloutDemon</h1>
    <select id="mapSelector">
        <option value="ascent">Ascent</option>
        <option value="bind">Bind</option>
        <option value="icebox">Icebox</option>
        <option value="split">Split</option>
        <option value="lotus">Lotus</option>
        <option value="breeze">Breeze</option>
        <option value="sunset">Sunset</option>
    </select>

    <button id="startButton">Start Game</button>
    <button id="saveButton">Save Callouts</button>

    <a href='settingPage.html'>
        <button id="settingButton">Setting</button>
    </a>

    <svg id="svgContainer" width="600" height="600">
        <image id="mapImage" xlink:href="" alt="Map Image" style="max-width: 600px; display: block; margin: auto;"/>
    </svg>
    <p id="calloutDisplay"></p>
    <div class="inline-container">
        <button id="addButton">Add Callout</button>
        <button id="delButton">Delete Callout</button>
    </div>
    <script src="eel.js"></script>
    <script type="module" src="MicInput.js"></script>
    <script type="module" src="FirebaseAppConnection.js"></script>
    <script type="module" src="MapStorage.js"></script>
    <script type="module" src="main.js"></script>
<div>
    <button id="signInButton">Create Account / Sign In</button>
    <button id="signOutButton">Sign Out</button>

    <div id="message">
        <p>You have signed in as <span id="userName"></span> with the email <span id="userEmail"></span> </p>
    </div>
<script type ="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
    import { GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged, getAuth } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDgFO86XXDuvyFrSPSmCA8YC8XcucAsVYw",
        authDomain: "callout-demon.firebaseapp.com",
        projectId: "callout-demon",
        storageBucket: "callout-demon.appspot.com",
        messagingSenderId: "968725959431",
        appId: "1:968725959431:web:40696e16e53bf0f25deba2",
        measurementId: "G-SSS8LJWJVR"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth();
    const provider = new GoogleAuthProvider()

    const signInButton = document.getElementById("signInButton");
    const signOutButton = document.getElementById("signOutButton");
    const message = document.getElementById("message");
    const userName = document.getElementById("userName");
    const userEmail = document.getElementById("userEmail");

    signOutButton.style.display = "none";
    message.style.display = "none";

    const userSignIn = async() => {
        signInWithPopup(auth, provider)
        .then((result) => {
            const user = result.user
            console.log(user);
            console.log(user.uid);
        }).catch((error) => {
            const errorCode = error.code;
            const errorMessage = error.message
        });
    }

    function getUserUUID() {
        return user.uid;
    }

    const userSignOut = async() => {
    signOut(auth).then(() => {
        alert("You have signed out successfully!");
    }).catch((error) => {});
}

    onAuthStateChanged(auth, (user) => {
    if(user) {
        signOutButton.style.display = "block";
        message.style.display = "block";
        userName.innerHTML = user.displayName;
        userEmail.innerHTML = user.email
    } else {
        signOutButton.style.display = "none";
        message.style.display = "none";
    }
})

    signInButton.addEventListener('click', userSignIn);
    signOutButton.addEventListener('click', userSignOut);
</script>
</body>
</html>